set search_path = raw_data, public;

create table temp_plots (
PLOTID                 VARCHAR(50)          not null,
EASTPLOT               VARCHAR(50)         null,
NORTHPLOT              VARCHAR(50)         null
);


INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (93,471711,6318768);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (104,479055,6290666);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (145,513903,6283992);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (190,492878,6262560);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (200,492927,6248754);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (224,464930,6255780);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (232,548863,6255693);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (246,541926,6235794);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (259,506916,6234905);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (283,590958,6255784);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (378,542023,6220758);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (419,513954,6213727);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (449,716977,6213831);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (458,703909,6207793);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (467,688979,6206921);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (516,450969,6178784);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (634,695898,6150815);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (762,569961,6129765);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (767,687904,6175838);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (785,723872,6101606);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (815,875266,6124633);
INSERT INTO temp_plots (PLOTID,EASTPLOT,NORTHPLOT) VALUES (877,695915,6073990);



SELECT PLOTID as code_plot, 'cluster_code', convert_latlon_dms2(Y(g)::varchar) AS latitude, convert_latlon_dms2(X(g)::varchar) AS longitude, '1', 'Converted' 
FROM (
	SELECT PLOTID, transform(GeometryFromText('POINT (' || EASTPLOT || ' ' || NORTHPLOT || ')', 23032), 4326) AS g
	FROM temp_plots
) AS req;
 
