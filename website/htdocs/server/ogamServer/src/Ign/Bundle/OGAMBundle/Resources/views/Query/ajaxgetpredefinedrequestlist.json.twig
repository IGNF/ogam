{% extends "base_with_total.json.twig" %}

{%- block predefined_request -%}{% autoescape false %}
[
    {{ datum.requestId|json_encode }},
    {{ datum.label|json_encode }},
    {{ datum.definition|json_encode }},
    {{ datum.date.format('Y-m-d')|json_encode }},
    {{ datum.isPublic|json_encode }},
    {# We assume that there is only one group per request #}
    {{ datum.groups[0].position|json_encode }},
    {{ datum.groups[0].groupId.groupId|json_encode }},
    {{ datum.groups[0].groupId.label|json_encode }},
    {{ datum.groups[0].groupId.position|json_encode }},
    {{ datum.datasetId.id|json_encode }},
    {{ datum.datasetId.label|json_encode }}
]
{% endautoescape %}{%- endblock -%}


{%- block response_data -%}
[
    {% for datum in data %}
        {{ block('predefined_request') }}
        {%- if not loop.last -%}
            ,
        {%- endif -%}
    {% endfor %}
]
{%- endblock -%}
