[
{% set patch = {
'xclass':'OgamDesktop.view.edition.Panel',
'dataId':dataId,
'mode':mode,
'dataTitle':(tableFormat.label|e),

'disableDeleteButton':FALSE,
'childrenConfigOptions':[],
} %}

{% if message is not  empty %}
    {% set patch= patch|merge({'message':message})  %}
{% endif %}

{# parent link #}
{% for ancestor in ancestors|reverse %}
	{% set link ={'url':'#edition-edit'~ancestor.id,'text':ancestor.tableFormat.label|e,'fields':''} %}
	{% set fields ={} %}
    	{% for field in data.fields %}
            {% if field.valueLabel is iterable %}
           	 {% set fields =fields|merge({"field.label": field.valueLabel|e|join(', ')}) %}
            {% else %}
            	{% set fields =fields|merge({"field.label":field.valueLabel|e}) %}
            {% endif %}
        {% endfor %}
        {% set link = link|merge({'fields':fields}) %}
	{% set patch = patch|merge({'parentLinks':patch.parentLinks|merge([link])}) %}
{% endfor %}

{# disableDeleteButton #}
{% set childCount =0 %}
{% for childTable in children %}
	{% set childCount = childCount + childTable.length %}
{% endfor %}

{% set patch = patch|merge({'disableDeleteButton':childCount >0})  %}


{# childrenConfigOptions #}
{% set childrenConfigOptions = %}


{{ patch|json_encode}}

]